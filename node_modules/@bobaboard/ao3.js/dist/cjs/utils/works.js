"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getWorkUrl = exports.getTagId = exports.getWorksPage = void 0;
const cheerio_1 = __importDefault(require("cheerio"));
const axios_1 = __importDefault(require("axios"));
const tags_1 = require("./tags");
const getWorksUrl = (tagName) => `${(0, tags_1.getTagUrl)(tagName)}/works`;
const getWorksPage = async (tagName) => {
    return cheerio_1.default.load((await axios_1.default.get(getWorksUrl(tagName))).data);
};
exports.getWorksPage = getWorksPage;
const getTagId = ($worksPage) => {
    var _a;
    return ((_a = $worksPage(".rss")[0]) === null || _a === void 0 ? void 0 : _a.attribs["href"].split("/")[2]) || null;
};
exports.getTagId = getTagId;
const getWorkUrl = ({ workId, chapterId, collectionName, }) => {
    let workUrl = `https://archiveofourown.org`;
    if (collectionName) {
        workUrl += `/collections/${collectionName}`;
    }
    workUrl += `/works/${workId}`;
    if (chapterId) {
        workUrl += `/chapters/${chapterId}`;
    }
    return workUrl;
};
exports.getWorkUrl = getWorkUrl;
