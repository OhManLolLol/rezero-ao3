"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getTagNameFromFeed = exports.getFeedPage = void 0;
const cheerio_1 = __importDefault(require("cheerio"));
const axios_1 = __importDefault(require("axios"));
const getFeedUrl = (tagId) => `https://archiveofourown.org/tags/${tagId}/feed.atom`;
const getFeedPage = async ({ tagId }) => {
    return cheerio_1.default.load((await axios_1.default.get(getFeedUrl(tagId))).data);
};
exports.getFeedPage = getFeedPage;
const getTagNameFromFeed = async ($feedPage) => {
    var _a;
    const feedTitle = $feedPage($feedPage("title")[0].children[0]).text();
    return ((_a = feedTitle.match(/AO3 works tagged '(.+)'/)) === null || _a === void 0 ? void 0 : _a[1]) || null;
};
exports.getTagNameFromFeed = getTagNameFromFeed;
